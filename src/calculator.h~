#ifndef CALCULATOR_H
#define CALCULATOR_H

#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <time.h>


#include "atomicsystem.h"

using namespace std;


class FingerprintCalculator {

    int size;
    double cutoff;
   
    AtomicSystem atomicsystem;

    double get_min_distance(double, double, double, bool);
    double dot(double *, double*);   
    double calculate_G2(int, double*, double);
    double calculate_G4(int, int, int*, double*, double, double, double);
    double cutoff_func(double);
    double calculate_cos_theta(int,int,int); 
    double *get_vector(int, int);
    int Kronecker(int, int);

    double cutoff_func_prime(double);
    int *dRij_dRml_vector(int, int, int, int);
    double dCos_theta_ijk_dR_ml(int i, int j, int k, int *, int m, int l);
    double dRij_dRml(int, int, double, int, int);
    double calculate_G2_prime(int, int, int *, double *, double, int, int);
    double calculate_G4_prime(int, int, int *, double *, double, double, double, int, int);


    public:
        FingerprintCalculator(AtomicSystem&, double);
        ~FingerprintCalculator();

        int get_size();
        double *calculate_fingerprint(int, int, int*, double*);

};


#endif
